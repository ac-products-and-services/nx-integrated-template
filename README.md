# JsTools

<a alt="Nx logo" href="https://nx.dev" target="_blank" rel="noreferrer"><img src="https://raw.githubusercontent.com/nrwl/nx/master/images/nx-logo.png" width="45"></a>

✨ **This workspace has been generated by [Nx, a Smart, fast and extensible build system.](https://nx.dev)** ✨

## Understand this workspace

Run `nx graph` to see a diagram of the dependencies of the projects.

## Remote caching

Run `npx nx connect-to-nx-cloud` to enable [remote caching](https://nx.app) and make CI faster.

## Further help

Visit the [Nx Documentation](https://nx.dev) to learn more.

## Semver

[@jscutlery/semver](https://github.com/jscutlery/semver)

After workspace.json was deprecated the main command do not work properly;

- https://github.com/jscutlery/semver/issues/547
- https://github.com/jscutlery/semver/issues/408

[lerna](https://lerna.js.org/docs/getting-started)

Lerna seems to be a more robust solution to deal with publishing and versioning. Besides, Nx team now is the official maintainer of Lerna, what gives us more assurance that the integration between both tools might be trustworthy.

It seams like we would need to switch to learna as main tool, and use nx as side-car tool. Lets leave it at that for now and go back to other options.

Lets see if [sonigaurav119](https://sonigaurav119.medium.com/how-i-use-lerna-with-nx-to-automate-the-versioning-1fada7f7f64f) could help us here... Working on it.

It worked! Now fixing some details, such as [version bumping](https://github.com/lerna/lerna/issues/2668) and other minor issues...
Maybe [this solution](https://github.com/lerna/lerna/issues/1273) works...

Issues:

- Minor and major versions are not consistently created. Only patch versions are created.

References:

- https://sonigaurav119.medium.com/how-i-use-lerna-with-nx-to-automate-the-versioning-1fada7f7f64f
- https://github.com/gauravsoni119/flair
- https://dev.to/xcanchal/monorepo-using-lerna-conventional-commits-and-github-packages-4m8m
- https://dev.to/xcanchal/automatic-versioning-in-a-lerna-monorepo-using-github-actions-4hij

[semantic-release-plus](https://medium.com/@guysenpai89/nx-monorepo-publish-libraries-to-github-packages-with-github-actions-semantic-release-970883f2786a)

It was promising, but ended up being a bit complicated and frustrating. Besides, we would introduce a dependency that is not very well maintained. The Medium articles by @guysenpaid89 helped a lot with the github actions though.

References:

- https://medium.com/@guysenpai89/nx-monorepo-publish-libraries-to-github-packages-with-github-actions-semantic-release-970883f2786a
- https://medium.com/@guysenpai89/nx-monorepo-publish-your-libraries-to-github-packages-with-github-actions-semantic-release-5f2c3fdffaa0
- https://medium.com/@guysenpai89/nx-monorepo-publish-your-libraries-to-github-packages-with-github-actions-semantic-release-fa9822467b24

[semantic-release](https://github.com/semantic-release/semantic-release)

We ended up going back to a single release for the entire monorepo, using semantic release for now. I still do not quite understand how will we handle the multi-package setup. How to change the version number for each one when publishing to github's npm registry?

References:

- https://dev.to/antongolub/the-chronicles-of-semantic-release-and-monorepos-5cfc

References:

- https://github.com/semantic-release/commit-analyzer

References:

- https://nx.dev/recipes/adopting-nx/lerna-and-nx#version-management-&-publishing
